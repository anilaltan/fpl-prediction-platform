# FPL Point Prediction Platform - Cursor Rules

## Project Overview
This is a professional SaaS platform for Fantasy Premier League (FPL) point prediction using Machine Learning. The project follows "Moneyball" principles for data-driven decision making and implements "DefCon" rules for robust error handling and rate limiting.

## Architecture

### Monorepo Structure
- `/backend` - FastAPI Python application for ML and API services
- `/frontend` - Next.js application with App Router and Tailwind CSS
- Root directory contains Docker Compose and shared configuration

### Technology Stack
- **Backend**: FastAPI (Python 3.11-slim), SQLAlchemy, PostgreSQL
- **Frontend**: Next.js 14 (App Router), React, TypeScript, Tailwind CSS
- **Database**: PostgreSQL 15
- **Orchestration**: Docker Compose with memory limits

### Key Principles

#### Moneyball Principles
- Statistical analysis over intuition
- Identify undervalued players through data
- Optimize team selection based on expected value
- Focus on predictive metrics rather than past performance alone

#### DefCon Rules
- Implement rate limiting for external API calls
- Graceful error handling and fallback mechanisms
- Health checks and monitoring
- Resource constraints awareness (memory limits enforced)

## Development Guidelines

### Backend
- Use type hints throughout Python code
- Follow FastAPI best practices for route definitions
- Implement proper error handling with HTTP status codes
- Use SQLAlchemy ORM for database operations
- ML models should be versioned and stored separately
- Services should be modular and testable

### Frontend
- Use TypeScript for type safety
- Follow Next.js App Router conventions
- Implement responsive design with Tailwind CSS
- Use server components where possible for performance
- Client components only when interactivity is needed

### Database
- Use migrations (Alembic) for schema changes
- Index frequently queried columns
- Implement soft deletes where appropriate
- Track model performance metrics

### Docker
- Keep images small (use slim/alpine variants)
- Respect memory limits (DB: 512MB, Frontend: 1GB)
- Use health checks for service dependencies
- Mount volumes for development hot-reload

## Environment Variables
- `DATABASE_URL` - PostgreSQL connection string
- `FPL_EMAIL` - FPL API credentials
- `FPL_PASSWORD` - FPL API credentials
- `SECRET_KEY` - Application secret key

## Code Style
- Python: Follow PEP 8, use Black formatter
- TypeScript: Follow ESLint rules, use Prettier
- Use meaningful variable and function names
- Add docstrings to public functions and classes
- Comment complex logic and algorithms

## Testing
- Write unit tests for ML models
- Test API endpoints with proper fixtures
- Test error handling scenarios
- Use integration tests for critical workflows
